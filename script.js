var acounts = [
    {
        "id": 0,
        "email": "admin@gmail.com",
        "username": "adminn",
        "password": "123456"

    }
];
// var recipes = [
//     {
//         "id": 1,
//         "name": "Мусака",
//         "image": "images/recepi/musaka.jpg",
//         "tag": "основни",
//         "howTo": "Загрявате мазнината в дълбок тиган или тенджера. В загрятата мазнина задушете измитият, изчистен и нарязан на дребно лук, докато омекне. Добавяте нарязаните на дребно половината домати и каймата, черният пипер и чубрицата, както и една чаена лъжица сол. Може да ползвате кайма, каквато имате под ръка, но най-вкусната мусаката става с кайма смес – 50% свинско и 50 % телешко месо.След като водата от доматите изври добавяте червения пипер. Измивате, почиствате, обелвате и нарязвате на дребни кубчета картофите и ги прибавяте към месото. Намазнявате тавичка на дъното на която поставяте другата половина от доматите и върху тях изсипвате сместа за мусака. Добавяте една непълна чаена чаша гореща вода и поставяте в предварително загрята на 200 градуса фурна. Печете до докато водата изври, а картофите станат златисти.Идва моментът за приготвяне на заливката за мусаката. Тя става лесно и много бързо. Разбърквате киселото мляко и яйцата, след което при постоянно бъркане добавяте и брашното, до получаване на гладка смес. Накрая добавяте и настъргания на дребно кашкавал. Заливате мусаката и печете докато порозовее.",
//         "ingredientsTM": "кайма-500гр \nлукк-2бр \nкисело мляко-400гр \nкашкавал-100гр \nолио-1 кафена чаша \nкарртофи-1кг  \nдомати-2бр \nяйца-2бр \nбрашно-5 супени лъжици \nчервен пипер-1 чаена лъжица",
//         "video": "https://www.youtube.com/watch?v=PMpzLbSaq_4"
//     },
//     {
//         "id": 2,
//         "name": "Торта Гараш",
//         "image": "images/recepi/garash.jpg",
//         "tag": "десерти",
//         "howTo": "Първата стъпка от рецептата за торта Гараш е подготовката на блатовете. Отделяте белтъците от жълтъците на 8 яйца. С помощта на миксер разбивате белтъците заедно с пресятата пудра захар докато станат на сняг. Добавяте пресятото брашно и смлените орехи разбърквате внимателно с дървена лъжица. Разпределяте сместа на 3 или 4 блата. В тава, например с падащи стени, слагате хартия за печене, слагате една част от сместа  печете в предварително загрята на 180 градуса фурна до придобиване на апетитен златист цвят. След изпичане оставете блатовете да се охладят добре.За приготвянето на крема за тортата Гараш, първо разтопете шоколада на водна баня. Може да използвате обикновен черен шоколад, но най-добре е да използвате шоколад за готвене. Разбийте сметаната със захарта до разтопяване на захарта, след което добавете разтопения шоколад при непрекъснато бъркане до получаване на хомогенна смес. Оставете крема да поизстине, за да стегне добре. Идва моментът, в който да сглобите тортата. В ринг, или просто в голяма чиния, в която ще сложите тортата Гараш слагате блат, върху него крем и повтаряте процедурата, докато блатовете свършат. Трябва да замажете тортата и отстрани. Оставете тортата да се охлади в хладилника.Финалният момент е подготовката на глазурата за тортата Гараш. Разтопявате на шоколада с кравето масло на водна баня докато стане хомогенно. Заливате тортата. Класическата рецепта за торта Гараш гласи, че в този момент следва да очертаете 16 парчета, за да можете да ги отрежете лесно, след като глазурата стегне, но и да не го направите (както е приготвена тортата на снимките) не е проблем. Отново според класическата рецепта тортата се поръсва в кръг със зелено боядиса кокосови стърготини. За да избегнем твърде изкуствения вид, в случая тортата е поръсена със смлян шам фъстък.",
//         "ingredientsTM": "пудрра заха-200гр \nбррашно-20гр \nзаквасена сметана-300гр \nзахар-1 чаша \nшоколда-400гр \nбелтъци-8бр  \nорехи-300гр \nкраве масло-1 супена лъжица",
//         "video": "https://www.youtube.com/watch?v=TQuz1tsaJq4"
//     },
//     {
//         "id": 3,
//         "name": "Картофи Соте",
//         "image": "images/recepi/sote.jpg",
//         "tag": "основни",
//         "howTo": "Измивате добре картофите, обелвате ги и ги слагате да поврат в подсолена вода. Картофите не трябва да стават много меки, трябва да останат полусварени, защото освен варенето ще бъдат подложени и на друга топлинна обработка и ако още в началото ги сварим, в последствие ще се разпаднат и вместо картофи соте, ще получите каша соте.Полусварените картофи се нарязват на едри парчета и се запържват, докато придобият златиста коричка в загрятото предварително масло. Мазнината за пържене на картофите трябва да е повечко, за да се изпържат добре.Накрая обърквате картофите със ситно нарязаните копър и чесън и ги оставяте на котлона за не повече от 1-2 минути. Възможно е нарязаните копър и чесън да добавите и след като свалите картофките от котлона и да не ги подлагате на топлинна обработка, тогава те ще останат по-свежи. Ако пък не сте любители на чесъна може да подправите картофите само с копър, макар че така вашите картофи ще се различават съществено от класическите картофи соте.",
//         "ingredientsTM": "картофи-1кг \nчесън-3 скилидки \nкопър-2 връзки \nкраве масло-30гр",
//         "video": ""
//     },
//     {
//         "id": 4,
//         "name": "Пилешки крилца на фурна",
//         "image": "images/recepi/krilca.jpg",
//         "tag": "основни",
//         "howTo": "Първата стъпка от рецептата за пилешки крилца на фурна е изборът и подготовката на крилцата. Избирате пилешки крилца с доказан произход от български производител, каквито са охладените пилешки крилца на Лудогорско пиле. Измивате пилешките крилца и ги срязвате на две части на сгъвка. Подсушавате ги много добре с помощта на кухненска хартия. Изсипвате ги в купа, поръсвате ги с бакпулвера, чесъна и солта и разбърквате много добре, за да стигнат съставките до всяко едно парченце пиле.В тава слагате хартия за печене и нареждате така овкусените пилешки крилца на малко разстояние едно от друго. Печете в предварително загрята на 200 градуса фурна, за около 30 минути, като след това обърнете крилцата и печете още около 10 минути, до придобиване на апетитен златист цвят.Докато крилцата са във фурната пригответе соса за тях, като в малка тенджера изсипете всички съставки са соса. Сложете тенджерата на котлона, за да заври соса при непрекъснато бъркане за около 3-4 минути, докато всички съставки се смесят и разтопят. Готовите леко изстинали пилешки крилца разбъркайте със соса, за да се овкусят. Преди сервиране поръсете със ситно нарязан пресен лук. Може да приготвите и млечен сос, като разбъркате в купа заквасената сметана, солта, черния пипер и сусамовия тахан. Този сос ще освежи и обогати вкуса.",
//         "ingredientsTM": "бакпулвер-1 супена лъжица \nсол-1 чаена лъжица \nдоматено пюре-2 чаени лъжици \nоцет-1 супена лъжица \nчерен пипер-2 чаени лужици \nсусамов тахан-1 супена лъжица \nпилешки крилца-1кг \nчесън на прах-2 чаени лъжици \nолио-2 чаени чаши \nмед-1 супена лъжица \nзаквасена сметана-1 чаша \nлимонен сок-1 чаена лъжица",
//         "video": ""
//     },
//     {
//         "id": 5,
//         "name": "Баница",
//         "image": "images/recepi/banitsa.jpg",
//         "tag": "закуски",
//         "howTo": "Първата стъпка от рецептата за баница със сирене и готови кори е подготовката на плънката. Разбърквате яйцата (предварително извадени от хладилника), киселото мляко, изварата / сиренето, ½ чаена чаша олио и содата за хляб. Може да ползвате и извара. Ако сте ползва извара добавете и около една равна чаена лъжица сол. Разбъркайте продуктите добре до получаване на хомогенна смес.В намазнена тавичка сложeте 1-2 листа от корите, върху които сложете около един черпак (за супа) от сместа. След което поръсете с няколко капки от останалото олио. Отгоре отново сложете лист-два от корите и отново от сместа, а накрая олио. Повтаряйте процедурата в тази последователност докато корите и сместа свършат.Последният лист от корите намажете с олио и много внимателно нарежете с остър нож на парчета, за да можете след изпичане на по-лесно да разрежете баницата на парчета. Печете баницата в предварително загрята на 200 градуса фурна за около 30 минути, докато баницата придобие златист цвят.",
//         "ingredientsTM": "точени кори-400гр \nяйца-4бр \nкисело мляко-400гр \nолио-4 чаени чаши \nсирене-300гр \nхлебна сода-1 чаена лъжица",
//         "video": ""
//     },
//     {
//         "id": 6,
//         "name": "Студен билков чай",
//         "image": "images/recepi/StudenChai.jpg",
//         "tag": "напитки",
//         "video": ""
//     },
//     {
//         "id": 7,
//         "name": "Бял горещ шоколад",
//         "image": "images/recepi/BqlShokolat.jpg",
//         "tag": "напитки",
//         "video": ""
//     },
//     {
//         "id": 8,
//         "name": "Овчарска салата",
//         "image": "images/recepi/ofcharska.jpg",
//         "tag": "салати",
//         "video": ""
//     },
//     {
//         "id": 9,
//         "name": "Зелена салата",
//         "image": "images/recepi/zelena.jpg",
//         "tag": "салати",
//         "video": ""
//     },
//     {
//         "id": 10,
//         "name": "Шоколадов кекс",
//         "image": "images/recepi/keks.jpg",
//         "tag": "десерти",
//         "video": ""
//     },
//     {
//         "id": 11,
//         "name": "Шоколадови бисквити",
//         "image": "images/recepi/biskviti.jpg",
//         "tag": "десерти",
//         "video": ""
//     },
//     {
//         "id": 12,
//         "name": "Палачинки",
//         "image": "images/recepi/palachinki.jpg",
//         "tag": "закуски",
//         "video": ""
//     },
//     {
//         "id": 13,
//         "name": "Хляб",
//         "image": "images/recepi/hlqb.jpg",
//         "tag": "закуски",
//         "video": ""
//     },
//     {
//         "id": 14,
//         "name": "Пилешка супа",
//         "image": "images/recepi/pileshka.jpg",
//         "tag": "супи",
//         "video": ""
//     },
//     {
//         "id": 15,
//         "name": "Копривена супа",
//         "image": "images/recepi/koprivena.jpg",
//         "tag": "супи",
//         "video": ""
//     }
// ];

var object_id;
var loaded = false;
var list = [];
var favRecipe = [];
//създава се масив в който ще се поставят рецептите
var recipesTRY = [];

function fetchRecipes() {
    fetch('get_recipes.php')
        .then(response => response.json())
        .then(data => {
            // запазват се извлечните данни в масива
            recipesTRY = data;

            // взема се елемнта на дива в който ще се поставят рецептите
            let recipe = document.getElementById('allContainer');

            let length = recipesTRY.length;
            //цъкъл за генериране на рецептите
            for (let i = 0; i < length; i++) {
                let all_div1 = document.createElement("div");
                all_div1.classList.add("col", "px-4");
                all_div1.setAttribute("id", recipesTRY[i].id);
                recipe.appendChild(all_div1);

                let all_div2 = document.createElement("div");
                all_div2.classList.add("card", "h-100", "border", "border-success-subtle");
                all_div2.onmouseover = function () {
                    all_div2.style.boxShadow = "0 .5rem 1rem #1E4847";
                    all_div2.style.borderStyle = "hidden";
                    all_div2.style.transitionDuration = "0.75s";
                }

                all_div2.onmouseleave = function () {
                    all_div2.style.boxShadow = "none";
                    all_div2.borderStyle = "solid";
                    all_div2.transitionDuration = "0.75s";
                }
                all_div1.appendChild(all_div2);

                let all_image = document.createElement("img");
                all_image.classList.add("card-img-top");
                all_image.src = recipesTRY[i].image;
                all_div2.appendChild(all_image);

                let all_div3 = document.createElement("div");
                all_div3.classList.add("card-body");
                all_div3.style.backgroundColor = "#A0E8AF";
                all_div2.appendChild(all_div3);

                let all_h = document.createElement("h5");
                all_h.classList.add("card-title");
                all_h.innerText = recipesTRY[i].name;
                all_div3.appendChild(all_h);

                all_div1.addEventListener("click", function () {
                    //запазва се id-то на конкретната рецепта  
                    object_id = i;
                    openOffCanva();
                });

            }

            console.log(recipesTRY);
            checkUserIDInLocalStorage();
            Last3();
        })
        //проверка за грешки
        .catch(error => console.error('Error fetching recipes:', error));
}

// Call the fetchRecipes function when the page loads
//document.addEventListener('DOMContentLoaded', fetchRecipes);
function Last3() {
    console.log(recipesTRY);
    let length = recipesTRY.length;
    
    let cont = document.getElementById('top3Con');

    
    for (let i = 0; i < length; i++) {
        if (i==length-2 ||i==length-1||i==length-3) {
            let all_div1 = document.createElement("div");
            all_div1.classList.add("col", "px-4");
            //all_div1.setAttribute("id", recipesTRY[i].id);
            cont.appendChild(all_div1);

            let all_div2 = document.createElement("div");
            all_div2.classList.add("card", "h-100", "border", "border-success-subtle");
            all_div2.onmouseover = function () {
                all_div2.style.boxShadow = "0 .5rem 1rem #1E4847";
                all_div2.style.borderStyle = "hidden";
                all_div2.style.transitionDuration = "0.75s";
            }

            all_div2.onmouseleave = function () {
                all_div2.style.boxShadow = "none";
                all_div2.borderStyle = "solid";
                all_div2.transitionDuration = "0.75s";
            }
            all_div1.appendChild(all_div2);

            let all_image = document.createElement("img");
            all_image.classList.add("card-img-top");
            all_image.src = recipesTRY[i].image;
            all_div2.appendChild(all_image);

            let all_div3 = document.createElement("div");
            all_div3.classList.add("card-body");
            all_div3.style.backgroundColor = "#A0E8AF";
            all_div2.appendChild(all_div3);

            let all_h = document.createElement("h5");
            all_h.classList.add("card-title");
            all_h.innerText = recipesTRY[i].name;
            all_div3.appendChild(all_h);

            all_div1.addEventListener("click", function () {
                //запазва се id-то на конкретната рецепта  
                object_id = i;
                console.log(object_id);
                openOffCanva();
            });
           
        }

    }




}

$(document).ready(function () {
    $('#registrationForm').submit(function (e) {
        e.preventDefault();

        //взема отговор от скрипта за регистрация и извежда съобщение
        $.ajax({
            type: 'POST',
            url: 'connect.php',
            data: $('#registrationForm').serialize(),
            success: function (response) {
                $('#message').html('<div class="alert alert-success">' + response + '</div>');
                $('#registrationForm')[0].reset();
                alert("Registration done");
            },
            error: function (xhr, status, error) {
                $('#message').html('<div class="alert alert-danger">Error: ' + xhr.responseText + '</div>');
            }
        });
    });

    //взема отговор от скрипта за влизане в акаунт и извежда съобщение
    $("#loginForm").submit(function (e) {
        e.preventDefault();
        $.ajax({
            type: "POST",
            url: "register.php",
            data: $(this).serialize(),
            success: function (response) {
                $('#loginForm')[0].reset();

                var jsonResponse = JSON.parse(response);
                if (jsonResponse.status === 'success') {

                    var userId = jsonResponse.id;


                    localStorage.setItem('userId', userId);

                    let a = document.getElementById('favourite');
                    a.classList.remove("d-none");

                    alert("Logged in successfully");
                    checkUserIDInLocalStorage();
                } else {
                    alert("Invalid email or password");
                }
            }
        });
    });


});


function SaveInfo() {

    let username = document.getElementById('user').value;
    let email = document.getElementById('emailLog').value;

    localStorage.setItem('is_username', username);
    localStorage.setItem('is_email', email);


}

// Define the function
function checkUserIDInLocalStorage() {

    var userID = localStorage.getItem('userId');
    if (userID) {


        console.log("User ID found in localStorage:", userID);
        // Here you can perform any actions you need when the userID is present
        $.ajax({
            type: "POST",
            url: "fetch_favorites.php", // Change this to the appropriate PHP script URL
            data: { userID: userID },
            success: function (response) {
                // Parse the response as JSON

                var favorites = JSON.parse(response);


                // Log the fetched favorites to the console
                console.log("Favorite recipes fetched successfully:", favorites);
                console.log(recipesTRY);
                // Now you can use the 'favorites' array as needed
                // For example, update the UI to display the fetched favorites
                console.log(favorites);
                let a = document.getElementById('favourite');
                a.classList.remove("d-none");

                let recipe = document.getElementById('FaveContainer');
                let length = favorites.length;
                let btn = document.getElementById('emptyFav');
                btn.classList.add("d-none");

                if (length > 1) {

                    for (let i = 0; i < length; i++) {
                        let all_div1 = document.createElement("div");
                        all_div1.classList.add("col", "px-4");
                        //all_div1.setAttribute("id", recipesTRY[favorites[i]].id);
                        recipe.appendChild(all_div1);
                        //console.log(current);

                        let all_div2 = document.createElement("div");
                        all_div2.classList.add("card", "h-100", "border", "border-success-subtle");
                        all_div2.onmouseover = function () {
                            all_div2.style.boxShadow = "0 .5rem 1rem #1E4847";
                            all_div2.style.borderStyle = "hidden";
                            all_div2.style.transitionDuration = "0.75s";
                        }

                        all_div2.onmouseleave = function () {
                            all_div2.style.boxShadow = "none";
                            all_div2.borderStyle = "solid";
                            all_div2.transitionDuration = "0.75s";
                        }
                        all_div1.appendChild(all_div2);

                        let all_image = document.createElement("img");
                        all_image.classList.add("card-img-top");
                        all_image.src = recipesTRY[[favorites[i]]].image;
                        all_div2.appendChild(all_image);

                        let all_div3 = document.createElement("div");
                        all_div3.classList.add("card-body");
                        all_div3.style.backgroundColor = "#A0E8AF";
                        all_div2.appendChild(all_div3);

                        let all_h = document.createElement("h5");
                        all_h.classList.add("card-title");
                        all_h.innerText = recipesTRY[favorites[i]].name;
                        all_div3.appendChild(all_h);

                        all_div1.addEventListener("click", function () {
                            object_id = favorites[i];
                            openOffCanva();
                        });
                        // console.log(current)

                    }
                }
                else {
                    btn.classList.remove('d-none');
                }


            },
            error: function (xhr, status, error) {
                console.error("Error fetching favorites:", error);
            }
        });
        return true; // Return true if userID is found
    } else {
        console.log("User ID not found in localStorage");
        return false; // Return false if userID is not found
    }
}

// Call the function when the page is loaded
window.onload = function () {
    fetchRecipes();

};


function changeAcounts() {
    activating('acounts');
    deactivating('search');
    deactivating('write');
    deactivating('enter');
    deactivating('favourite');

    document.getElementById('account_user').textContent = localStorage.getItem('is_username');
    document.getElementById('account_email').textContent = localStorage.getItem('is_email');

}

function changeSearch() {
    activating('search');
    deactivating('acounts');
    deactivating('write');
    deactivating('enter');
    deactivating('favourite');


    let a = document.getElementById('mainpage');
    a.classList.add("d-none");

    let c = document.getElementById('SearchPage');
    c.classList.remove("d-none");

    let b = document.getElementById('LoginReg');
    b.classList.add("d-none");

    let d = document.getElementById('favePage');
    d.classList.add("d-none");

    deactivatingF('osn');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('nap');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');

    if (loaded == false) {
        // fetchRecipes();
        loaded = true;
    }

    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;



    let emp = document.getElementById('empty');
    emp.classList.add("d-none");

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }


}

function changeWrite() {
    activating('write');
    deactivating('acounts');
    deactivating('search');
    deactivating('enter');
    deactivating('favourite');

}

function changeEnter() {
    activating('enter');
    deactivating('acounts');
    deactivating('write');
    deactivating('search');
    deactivating('favourite');

    let a = document.getElementById('mainpage');
    a.classList.add("d-none");

    let c = document.getElementById('SearchPage');
    c.classList.add("d-none");

    let b = document.getElementById('LoginReg');
    b.classList.remove("d-none");

    let d = document.getElementById('favePage');
    d.classList.add("d-none");



}

function changeFave() {
    activating('favourite');
    deactivating('acounts');
    deactivating('write');
    deactivating('enter');
    deactivating('search');

    let a = document.getElementById('mainpage');
    a.classList.add("d-none");

    let c = document.getElementById('SearchPage');
    c.classList.add("d-none");

    let b = document.getElementById('LoginReg');
    b.classList.add("d-none");

    let d = document.getElementById('favePage');
    d.classList.remove("d-none");


    var userID = localStorage.getItem('userId');
    console.log(userID);
    console.log(list);
    $.ajax({
        type: "POST",
        url: "fave.php",
        data: { userID: userID, favorites: list },
        success: function (response) {
            console.log("Favorites saved successfully");
        },
        error: function (xhr, status, error) {
            console.error("Error:", error);
        }
    });


    LoadFave();

}

function changeHome() {
    deactivating('favourite');
    deactivating('acounts');
    deactivating('write');
    deactivating('enter');
    deactivating('search');


    let a = document.getElementById('mainpage');
    a.classList.remove("d-none");

    let c = document.getElementById('SearchPage');
    c.classList.add("d-none");

    let b = document.getElementById('LoginReg');
    b.classList.add("d-none");

    let d = document.getElementById('favePage');
    d.classList.add("d-none");
}

function ChangeLogIn() {
    let a = document.getElementById('logIn');
    a.classList.remove("d-none");
    let c = document.getElementById('lInbtn');
    c.style.backgroundColor = "#FFFFFF";
    c.classList.add("border-bottom-0");
    c.classList.remove("border-start-0");
    c.classList.remove("border-black");
    c.classList.remove("border-top-0");
    c.classList.remove("border-end-0");


    let b = document.getElementById('signUp');
    b.classList.add("d-none");
    let d = document.getElementById('sUpbtn');
    d.style.backgroundColor = "#EDEAD0";
    d.classList.remove("border-bottom-0");
    d.classList.add("border-start-0");
    d.classList.add("border-black");
    d.classList.add("border-top-0");
    d.classList.add("border-end-0");
}

function ChangeSignIn() {
    let b = document.getElementById('signUp');
    b.classList.remove("d-none");
    let d = document.getElementById('sUpbtn');
    d.style.backgroundColor = "#FFFFFF";
    d.classList.add("border-bottom-0");
    d.classList.remove("border-start-0");
    d.classList.remove("border-black");
    d.classList.remove("border-top-0");
    d.classList.remove("border-end-0");

    let a = document.getElementById('logIn');
    a.classList.add("d-none");
    let c = document.getElementById('lInbtn');
    c.style.backgroundColor = "#EDEAD0";
    c.classList.remove("border-bottom-0");
    c.classList.add("border-start-0");
    c.classList.add("border-black");
    c.classList.add("border-top-0");
    c.classList.add("border-end-0");
}

function activating(btn) {
    let a = document.getElementById(btn)
    a.style.backgroundColor = "#EDEAD0";
    a.style.color = "#000000";
    a.classList.remove("btn-success");
    a.classList.add("btn-outline-success");

    btn += 'Nav';

    let b = document.getElementById(btn)
    b.style.backgroundColor = "#EDEAD0";
    b.style.color = "#000000";
    b.classList.remove("btn-success");
    b.classList.add("btn-outline-success");

    btn += 'F';
    let c = document.getElementById(btn)
    c.style.backgroundColor = "#29aafe";

}

function deactivating(btn) {
    let a = document.getElementById(btn);
    a.style.backgroundColor = null;
    a.style.color = null;
    a.classList.add("btn-success");
    a.classList.remove("btn-outline-success");

    btn += 'Nav';
    let b = document.getElementById(btn);
    b.style.backgroundColor = null;
    b.style.color = null;
    b.classList.add("btn-success");
    b.classList.remove("btn-outline-success");

    btn += 'F';
    let c = document.getElementById(btn)
    c.style.backgroundColor = null;

}

function activatingF(btn) {
    let a = document.getElementById(btn)
    a.style.backgroundColor = "#EDEAD0";
    a.style.color = "#000000";
    a.classList.remove("btn-success");
    a.classList.add("btn-outline-success");

}

function deactivatingF(btn) {
    let a = document.getElementById(btn);
    a.style.backgroundColor = null;
    a.style.color = null;
    a.classList.add("btn-success");
    a.classList.remove("btn-outline-success");
}

function addRecipe() {
    var formData = new FormData($('#insertForm')[0]);
    $.ajax({
        url: 'add_recipe.php',
        type: 'POST',
        data: formData,
        processData: false,
        contentType: false,
        success: function (response) {
            // Display alert with response message
            alert(response);
            // Reset form after successful submission (optional)
            $('#insertForm')[0].reset();
        },
        error: function (xhr, status, error) {
            // Display error message if request fails
            alert('An error occurred while adding the recipe: ' + error);
        }
    });
}

// проверява дали паролите съвпадат
function checkPass() {
    var pass1 = document.getElementById('password');
    var pass2 = document.getElementById('pass2');
    var message = document.getElementById('confirmMessage');
    var goodColor = "#66cc66";
    var badColor = "#ff6666";
    // ако съвпад се оцветява в зелено и се извежда съобщение
    if (pass1.value == pass2.value) {
        pass2.style.backgroundColor = goodColor;
        message.style.color = goodColor;
        message.innerHTML = "Passwords Match"
    } else {
        //ако не съвпадат се оцветява в червено и се извежда съобщение
        pass2.style.backgroundColor = badColor;
        message.style.color = badColor;
        message.innerHTML = "Passwords Do Not Match!"
    }
}
function Validate(txt) {
    txt.value = txt.value.replace(/[^a-zA-Z-'\n\r.]+/g, '');
}
//валидация на имейла
function email_validate(email) {
    var regMail = /^([_a-zA-Z0-9-]+)(\.[_a-zA-Z0-9-]+)*@([a-zA-Z0-9-]+\.)+([a-zA-Z]{2,3})$/;

    if (regMail.test(email) == false) {
        document.getElementById("status").innerHTML = "<span class='warning'>Email address is not valid yet.</span>";
    }
    else {
        document.getElementById("status").innerHTML = "<span class='valid'>Thanks, you have entered a valid Email address!</span>";
    }
}

function CheckRegestration() {
    let a = document.getElementById('emailLog');
    let b = document.getElementById('user');
    let c = document.getElementById('pass3');

    var logIn = false;
    for (let i = 0; i < acounts.length; i++) {
        console.log("1");
        if (a.value == acounts[i].email && b.value == acounts[i].username && c.value == acounts[i].password) {
            console.log("2");
            alert("Sucessfully logged in.");
            logIn = true;
            break;
        }
    }
    if (logIn == false) {
        alert("Incorrect information.");
    }
    a.value = '';
    b.value = '';
    c.value = '';

    if (logIn == true) {
        changeHome();
    }
}

function LogInAndClear() {
    let a = document.getElementById('email');
    let b = document.getElementById('txt');
    let c = document.getElementById('password');
    let d = document.getElementById('pass2');
    let message = document.getElementById('confirmMessage');
    let status = document.getElementById('status');

    d.style.backgroundColor = null;
    message.style.color = null;
    message.innerHTML = '';
    status.innerHTML = '';
}


//функция за филтриране
function FilterDes() {

    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");
    let br;

    //проверява дали някоя рецепта има d-none и го премахва. За да могат да се покажат всички рецепти
    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    //цикъл който осъществява филтъра
    for (let i = 0; i < length; i++) {
        //взема елемент чрез id и проверява в таблицата дали този елемент е в пеавилната категория. Ако не е му се добавя d-none  за да се скрие
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "десерти") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }

    }
    // активиране на съответния бутон и деактивира ако има други активи бутони
    activatingF('des');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('osn');
    deactivatingF('sup');
    deactivatingF('nap');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');

}


// семантично с описаната
function FilterOsn() {

    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");
    let br;

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "основни") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }
    }
    activatingF('osn');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('nap');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');

}


// семантично с описаната
function FilterZaks() {

    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");
    let br;

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "закуски") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }
    }
    activatingF('zak');
    deactivatingF('osn');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('nap');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');
}


// семантично с описаната
function FilterSal() {

    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");
    let br;

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "салати") {
            test.classList.add("d-none");
            let emp = document.getElementById('empty');
            emp.classList.add("d-none");
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }
    }
    activatingF('sal');
    deactivatingF('zak');
    deactivatingF('osn');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('nap');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');

}


// семантично с описаната
function FilterSup() {

    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");
    let br;

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "супи") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }
    }
    activatingF('sup');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('osn');
    deactivatingF('nap');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');

}


// семантично с описаната
function FilterNap() {

    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");
    let br;

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }


    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "напитки") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }
    }
    activatingF('nap');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('osn');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');

}

// семантично с описаната
function FilterVeg() {
    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;
    var br = 0;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "веган") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }

    }
    activatingF('veg');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('osn');
    deactivatingF('nap');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('keto');
}

// семантично с описаната
function FilterVegAr() {
    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;
    var br = 0;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "вегетарянски") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }

    }
    activatingF('vegAr');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('osn');
    deactivatingF('veg');
    deactivatingF('nap');
    deactivatingF('mor');
    deactivatingF('keto');
}

// семантично с описаната
function FilterMor() {
    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;
    var br = 0;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "морски") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }

    }
    activatingF('mor');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('osn');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('nap');
    deactivatingF('keto');
}

// семантично с описаната
function FilterKeto() {
    let recipe = document.getElementById('allContainer');

    let length = recipesTRY.length;
    var br = 0;

    let emp = document.getElementById('empty');
    emp.classList.add("d-none");

    for (let i = 0; i < length; i++) {
        let check = document.getElementById(recipesTRY[i].id);
        if (check.classList.contains('d-none')) {
            check.classList.remove("d-none");
        }

    }

    for (let i = 0; i < length; i++) {
        let test = document.getElementById(recipesTRY[i].id);
        if (recipesTRY[i].tag != "кето") {
            test.classList.add("d-none");
            br++;
        }
        if (br == length) {

            emp.classList.remove("d-none");
        }

    }
    activatingF('keto');
    deactivatingF('zak');
    deactivatingF('sal');
    deactivatingF('des');
    deactivatingF('sup');
    deactivatingF('osn');
    deactivatingF('veg');
    deactivatingF('vegAr');
    deactivatingF('mor');
    deactivatingF('nap');
}

// отваря рецепта
function openOffCanva() {
    event.preventDefault();
    //вземат се HTML елементите чрез id
    let page = document.getElementById('body');
    let ingredients = document.getElementById("ingredients");
    let name_of_offcanva = document.getElementById("name-of-offcanva");
    let image_of_offcanva = document.getElementById("image-of-offcanva");
    let HowToRec = document.getElementById("HowToRec");

    page.classList.remove("overflow-y-auto");
    //зарежда се информация в елементите
    name_of_offcanva.innerText = recipesTRY[object_id].name;
    HowToRec.innerText = recipesTRY[object_id].howTo;
    image_of_offcanva.src = recipesTRY[object_id].image;
    ingredients.innerText = recipesTRY[object_id].ingredientsTM;



    url = recipesTRY[object_id].video;
}

//затваря рецептата
function closeOffcanva() {
    let page = document.getElementById('body');
    page.classList.add("overflow-y-auto");
}

//отваряне на видеото
function openVideo() {
    if (url == "") {
        alert("За съжаление все още не можем да ви предоставим видео");
    }
    else {
        window.open(url, "_blank");
    }

}

//добавяне на рецепта в любими
function GetFave() {
    list.push(object_id);
    alert("Успешно добвихте " + recipesTRY[object_id].name + " в Любими");
}

var last_recepie = 0;
function LoadFave() {
    let recipe = document.getElementById('FaveContainer');
    let length = list.length;
    let current = list[0];
    //console.log(recipes[list[0]].name);
    //console.log(current);
    let btn = document.getElementById('emptyFav');
    btn.classList.add("d-none");
    //console.log(length);

    if (list[0] != null || favorites.length > 2) {
        for (let i = last_recepie; i < length; i++) {
            let all_div1 = document.createElement("div");
            all_div1.classList.add("col", "px-4");
            all_div1.setAttribute("id", recipesTRY[list[i]].id);
            recipe.appendChild(all_div1);
            console.log(current);

            let all_div2 = document.createElement("div");
            all_div2.classList.add("card", "h-100", "border", "border-success-subtle");
            all_div2.onmouseover = function () {
                all_div2.style.boxShadow = "0 .5rem 1rem #1E4847";
                all_div2.style.borderStyle = "hidden";
                all_div2.style.transitionDuration = "0.75s";
            }

            all_div2.onmouseleave = function () {
                all_div2.style.boxShadow = "none";
                all_div2.borderStyle = "solid";
                all_div2.transitionDuration = "0.75s";
            }
            all_div1.appendChild(all_div2);

            let all_image = document.createElement("img");
            all_image.classList.add("card-img-top");
            all_image.src = recipesTRY[[list[i]]].image;
            all_div2.appendChild(all_image);

            let all_div3 = document.createElement("div");
            all_div3.classList.add("card-body");
            all_div3.style.backgroundColor = "#A0E8AF";
            all_div2.appendChild(all_div3);

            let all_h = document.createElement("h5");
            all_h.classList.add("card-title");
            all_h.innerText = recipesTRY[list[i]].name;
            all_div3.appendChild(all_h);

            all_div1.addEventListener("click", function () {
                object_id = list[i];
                openOffCanva();
            });
            // console.log(current)
            current++;

            last_recepie = length;
        }
    }
    else {
        btn.classList.remove("d-none");
    }

}

function CloseAcc() {
    let acc = document.getElementById('acounts');

    acc.style.backgroundColor = null;
    acc.style.color = null;
    acc.classList.add("btn-success");
    acc.classList.remove("btn-outline-success");

    let accNav = document.getElementById('acountsNav');

    accNav.style.backgroundColor = null;
    accNav.style.color = null;
    accNav.classList.add("btn-success");
    accNav.classList.remove("btn-outline-success");
}

function CloseCreate() {
    let acc = document.getElementById('write');

    acc.style.backgroundColor = null;
    acc.style.color = null;
    acc.classList.add("btn-success");
    acc.classList.remove("btn-outline-success");

    let accNav = document.getElementById('writeNav');

    accNav.style.backgroundColor = null;
    accNav.style.color = null;
    accNav.classList.add("btn-success");
    accNav.classList.remove("btn-outline-success");
}

function LogOut() {
    localStorage.removeItem("is_username");
    localStorage.removeItem("is_email");
    localStorage.removeItem("userId");
    document.getElementById('account_user').textContent = "";
    document.getElementById('account_email').textContent = "";
    let a = document.getElementById('favourite');
    a.classList.add("d-none");
    changeHome();
    location.reload();
}

var image;
var leftcanvas;


function upload() {
    image = document.getElementById("imagefile");
    leftcanvas = document.getElementById("leftcan");
    rightcanvas = document.getElementById("rightcan");
    image = new SimpleImage(image);
    image.drawTo(leftcanvas);
}

